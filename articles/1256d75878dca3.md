---
title: "FastAPIã§JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¤±æ•—ã—ãŸã¨ã"
emoji: "ğŸ‘»"
type: "tech"
topics:
  - "python"
  - "jwt"
  - "fastapi"
  - "restclient"
published: true
published_at: "2023-01-01 18:43"
---

## ã¯ã˜ã‚ã«
FastAPIã§JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å®Ÿè£…ã—ã¾ã—ãŸ[^1]ã€‚

ã¨ã“ã‚ãŒREST Client[^2]ã‚’ä½¿ã£ã¦å®Ÿè£…ã—ãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å©ã“ã†ã¨ã—ãŸã¨ã“ã‚ã€`422 Unprocessable Entity`ãŒå‡ºã¦ã—ã¾ã„å°‘ã—ã ã‘ãƒãƒã£ãŸã®ã§ã€ã“ã“ã«è§£æ±ºæ–¹æ³•ã‚’æ®‹ã—ã¦ãŠãã¾ã™ã€‚


## çµè«–
ä»¥ä¸‹ã®ã‚ˆã†ã«httpãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—[^3]ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é£›ã°ã›ã°OKã§ã™ã€‚

```http: token_success.http
POST http://127.0.0.1:8000/token/
content-type: application/x-www-form-urlencoded

username=johndoe
&password=secret
```

## åŸå› 
ä¸Šæ‰‹ãã„ã‹ãªã‹ã£ãŸåŸå› ã¯ä¸‹è¨˜ã®2ã¤ã§ã—ãŸã€‚
- ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§`content-type: application/x-www-form-urlencoded`ã‚’å—ã‘ä»˜ã‘ã¦ã„ã‚‹ã®ã«ã€`content-type: application/json`ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦ã„ãŸã€‚
- ãƒœãƒ‡ã‚£ã®æ›¸ãæ–¹ã‚’é–“é•ãˆã¦ã„ãŸã€‚

content-typeã®é–“é•ã„ã«ã¯ã™ãæ°—ä»˜ã„ãŸã‚‚ã®ã®ã€ãƒœãƒ‡ã‚£ã®æ›¸ãæ–¹ã‚’é–“é•ãˆãŸã¾ã¾ã ã£ãŸã®ã§å°‘ã—ãƒãƒã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚ã¡ãªã¿ã«å…ƒã€…ã“ã®ã‚ˆã†ã«æ›¸ã„ã¦ã„ã¾ã—ãŸã€‚

```http: token_error.http
POST http://127.0.0.1:8000/token/
# content-typeã¯ä¿®æ­£ã—ãŸ
content-type: application/x-www-form-urlencoded

# ãƒœãƒ‡ã‚£ã®æ›¸ãæ–¹ã‚’é–“é•ãˆãŸã¾ã¾ã ã£ãŸ
{
  "username": "johndoe",
  "password: "secret"
}
```


## ãŠã‚ã‚Šã«
ãšã£ã¨ãƒœãƒ‡ã‚£ã®ã‚¹ãƒšãƒ«ã‚„ã‚¯ã‚©ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨ç¨ã‚ã£ã“ã—ã¦ã„ã¾ã—ãŸã€‚


## ãŠã¾ã‘
ã“ã®å¾Œæ™®é€šã«GETã—ãŸã‚‰`401 Unauthorized`ã¨æ€’ã‚‰ã‚ŒãŸã®ã§ãŠã¾ã‘ã€‚
å–å¾—ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã¯ãƒ˜ãƒƒãƒ€ãƒ¼ã«å…¥ã‚Œã¾ã—ã‚‡ã†ï¼ˆå½“ãŸã‚Šå‰ï¼‰ã€‚
```http: items.http
GET http://127.0.0.1:8000/items/
Authorization: Bearer ThisIsJwtToken
```


[^1]: [ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆãŠã‚ˆã³ãƒãƒƒã‚·ãƒ¥åŒ–ï¼‰ã«ã‚ˆã‚‹OAuth2ã€JWTãƒˆãƒ¼ã‚¯ãƒ³ã«ã‚ˆã‚‹Bearer - FastAPI](https://fastapi.tiangolo.com/ja/tutorial/security/oauth2-jwt/)
[^2]: [REST Client - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=humao.rest-client)
[^3]: [[VSCode][Rest Client]ãƒ•ã‚©ãƒ¼ãƒ å½¢å¼ã®POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ - Qiita](https://qiita.com/mgmgmogumi/items/9a19aef18dbaad7ea7b3)